services:
  # Backend API (.NET) via Docker (Render does not support native dotnet runtime; requires Docker, plan starter)
  - type: web
    name: inovasaude-backend-2
    runtime: docker
    plan: starter
    dockerfilePath: backend/Dockerfile
    autoDeploy: true
    envVars:
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      - key: PORT
        value: "5000"
      - key: ConnectionStrings__DefaultConnection
        fromDatabase:
          name: inovasaude-db
          property: connectionString
      - key: Jwt__SecretKey
        generateValue: true
      - key: Jwt__Issuer
        value: InovaSaude
      - key: Jwt__Audience
        value: InovaSaude
      - key: Jwt__ExpirationMinutes
        value: "60"
      - key: Cors__AllowedOrigins
        value: "https://inovasaude-frontend-static.onrender.com"
    healthCheckPath: /health

  # Frontend Static Site (Render spec: type web + runtime static)
  - type: web
    name: inovasaude-frontend-static
    runtime: static
    rootDir: frontend
    buildCommand: "npm install && npm run build"
    staticPublishPath: dist
    envVars:
      - key: VITE_API_URL
        value: "https://inovasaude-backend-2.onrender.com/api"

databases:
  - name: inovasaude-db
    plan: free
    postgresMajorVersion: "18"
